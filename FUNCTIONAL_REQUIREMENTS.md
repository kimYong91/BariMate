# 기능 요구사항 명세서

## 1. 사용자 인증 (Authentication)

### FR-001: 회원가입
-   **개요:** 사용자가 서비스 이용을 위해 계정을 생성합니다.
-   **상세 설명:**
    -   **선행 조건:** -
    -   **입력:** 아이디(이메일 형식), 비밀번호, (선택적) 닉네임
    -   **처리 과정:**
        1.  **프론트엔드에서 Firebase Authentication**을 사용하여 이메일/비밀번호 기반 신규 사용자 생성.
        2.  성공 시, 해당 사용자 정보를 **FastAPI 백엔드**로 전달하여 PostgreSQL `users` 테이블에 내부 사용자 정보 생성/매핑.
        3.  (선택적) 사용자의 닉네임 등 추가 프로필 정보는 **FastAPI 백엔드**를 통해 PostgreSQL에 저장.
        4.  기본 인증 정보는 Firebase Authentication에 안전하게 저장/관리됨.
    -   **출력/결과:** 회원가입 성공 메시지, 자동 로그인 또는 로그인 페이지로 이동.
    -   **후행 조건:** 사용자 계정 생성됨 (Firebase Auth 및 내부 DB), 로그인 가능 상태.
-   **비고:** 소셜 로그인 기능 (Google, Facebook 등)도 유사하게 Firebase Authentication을 활용하고 FastAPI 백엔드와 연동.

### FR-002: 로그인
-   **개요:** 등록된 사용자가 서비스에 접근하고, 애플리케이션을 종료하거나 재시작한 후에도 로그인 상태가 유지되도록 합니다.
-   **상세 설명:**
    -   **선행 조건:** 회원가입 완료
    -   **입력:** 아이디(이메일), 비밀번호
    -   **처리 과정:**
        1.  **프론트엔드에서 Firebase Authentication**을 사용하여 이메일/비밀번호로 사용자 로그인.
        2.  로그인 성공 시, Firebase SDK는 ID 토큰을 발급. 프론트엔드는 이 ID 토큰을 **FastAPI 백엔드 API** 호출 시 인증 헤더에 포함하여 전달.
        3.  **FastAPI 백엔드**는 전달받은 Firebase ID 토큰을 검증하여 사용자를 식별하고 API 접근 허용.
        4.  Firebase는 로그인 상태 지속성(Persistence)을 관리하여 앱/웹 재시작 시 자동 로그인을 지원.
    -   **출력/결과:** 로그인 성공 메시지, 메인 페이지로 이동. FastAPI 백엔드는 Firebase ID 토큰으로 인증.
    -   **후행 조건:** 사용자 로그인 상태.
-   **비고:** Access Token/Refresh Token의 복잡한 관리는 Firebase SDK가 담당. FastAPI 백엔드는 Firebase ID 토큰의 유효성만 검증.

### FR-003: 로그아웃
-   **개요:** 사용자가 서비스 이용을 종료합니다.
-   **상세 설명:**
    -   **선행 조건:** 로그인 상태
    -   **입력:** 로그아웃 요청
    -   **처리 과정:** **프론트엔드에서 Firebase Authentication**을 사용하여 사용자 로그아웃 처리.
    -   **출력/결과:** 로그아웃 성공, 로그인 페이지로 이동.
    -   **후행 조건:** 사용자 로그아웃 상태.
-   **비고:** -

## 2. 메모 및 용어 정리

### FR-004: 텍스트 메모 입력
-   **개요:** 사용자가 기술 용어 학습을 위한 내용을 텍스트로 입력하고 저장하며, AI 분석을 위한 준비를 합니다.
-   **상세 설명:**
    -   **선행 조건:** 로그인 상태
    -   **입력:** 메모 제목, 메모 내용 (**일반 텍스트**), 관련 주제(태그) 선택/입력, 카테고리 선택, 중요도 표시
    -   **처리 과정:**
        1.  입력 값 유효성 검사 (프론트엔드 및 **FastAPI 백엔드**).
        2.  메모 정보를 **FastAPI 백엔드 API**를 통해 **PostgreSQL** DB에 저장 (사용자 ID와 연결, 자동 저장 기능은 프론트엔드에서 구현 후 백엔드에 주기적 또는 최종 저장 요청).
        3.  (사용자 액션) 본문 내용에서 AI로 용어 추출 버튼 클릭 시 FR-006으로 연계 (프론트엔드에서 **FastAPI 백엔드**의 관련 API 호출).
    -   **출력/결과:** 메모 저장 (자동 저장 시 프론트엔드에서 임시 상태 관리, 최종 저장 시 백엔드 응답), (버튼 클릭 시) 추출된 용어 정보와 함께 FR-006으로 전달.
    -   **후행 조건:** 새로운 메모 생성됨 (PostgreSQL), 또는 AI 분석을 위해 내용 전달 준비 완료.
-   **비고:** 카테고리 및 중요도는 별도 FR에서 상세 정의. 최종 설명 콘텐츠는 마크다운 형식으로 **PostgreSQL**에 텍스트로 저장.

### FR-005: (신규) 카테고리 관리
-   **개요:** 사용자가 메모 분류를 위해 자신만의 카테고리를 생성, 수정, 삭제합니다.
-   **상세 설명:**
    -   **선행 조건:** 로그인 상태
    -   **입력:** 카테고리명, (수정/삭제 시) 대상 카테고리 ID
    -   **처리 과정:**
        1.  (생성 시) 카테고리명 유효성 검사, 중복 검사 (사용자 범위 내, **FastAPI 백엔드**에서 처리).
        2.  카테고리 정보 **FastAPI 백엔드 API**를 통해 **PostgreSQL** DB CRUD 작업 (사용자 ID와 연결).
    -   **출력/결과:** 작업 성공/실패 메시지, 업데이트된 카테고리 목록.
    -   **후행 조건:** 사용자의 카테고리 목록 변경됨.
-   **비고:** 사용자 프로필/설정 페이지 내에서 관리 인터페이스 제공 (`PAGE_LIST.md` 참고).

### FR-006: AI 기반 용어 자동 정리 및 설명
-   **개요:** 사용자가 입력한 메모 텍스트에서 추출된 용어들을 AI가 설명하고, 사용자는 이를 검토 및 저장합니다.
-   **상세 설명:**
    -   **선행 조건:** 로그인 상태, 정리할 텍스트 메모(FR-004)에서 용어 추출이 완료된 상태 (또는 사용자가 직접 용어 입력).
    -   **입력:** FR-004에서 추출/선택된 용어 목록 (또는 사용자 직접 입력 용어), (필요시) 원본 텍스트의 전체 또는 일부 맥락, 설명 요청.
    -   **처리 과정:**
        1.  선택된 용어들과 (필요시) 맥락 정보를 프론트엔드에서 **FastAPI 백엔드**의 특정 API로 전달.
        2.  **FastAPI 백엔드**는 AI 모델(Google Gemini API, `backend/prompts.py` 활용)을 호출하여 각 용어에 대한 설명을 생성.
        3.  생성된 용어와 설명을 프론트엔드에 반환하여 사용자에게 목록 또는 표 형태로 표시.
        4.  사용자가 생성된 내용을 편집/수정 가능하도록 인터페이스 제공 (예: 설명 수정, 용어 삭제/추가).
        5.  개인 이미지/자료 첨부 시, 프론트엔드에서 이미지를 **Cloud Storage for Firebase**에 직접 업로드 (또는 FastAPI 백엔드 경유) 후, 반환된 URL을 포함한 최종 정리 내용을 **FastAPI 백엔드**를 통해 **PostgreSQL**에 저장 (FR-007과 연계).
    -   **출력/결과:** 용어 및 AI 생성 설명 목록, 편집 인터페이스.
    -   **후행 조건:** AI에 의해 생성되고 사용자가 검토한 용어 정리 내용 확보 (PostgreSQL).
-   **비고:** AI 모델 프롬프트 최적화 필요. 설명 품질 관리 방안 필요. AI 생성 설명은 마크다운 형식으로 **PostgreSQL**에 저장.

### FR-007: 개인별 용어/설명 저장 및 재열람
-   **개요:** 사용자가 직접 작성하거나 AI가 생성해준 용어 정리 내용을 개인 공간에 저장하고 언제든지 다시 볼 수 있습니다.
-   **상세 설명:**
    -   **선행 조건:** 로그인 상태, 저장할 용어 정리 내용 존재 (FR-004, FR-006의 결과).
    -   **입력:** 저장할 용어 정리 데이터 (제목, 내용, 주제/태그, 카테고리, 중요도, 원본 메모 링크 등).
    -   **처리 과정:**
        1.  **FastAPI 백엔드**에서 텍스트 및 설명에 대한 임베딩 벡터 생성 (예: `sentence-transformers` 사용).
        2.  용어 정리 데이터 (임베딩 벡터 포함)를 **FastAPI 백엔드 API**를 통해 **PostgreSQL** DB에 저장 (사용자 ID와 연결, pgvector 타입 필드 활용).
    -   **출력/결과:** 저장 성공 메시지, 용어 목록 또는 상세 보기 화면으로 이동.
    -   **후행 조건:** 사용자의 개인 용어 사전에 새로운 항목 추가됨 (PostgreSQL).
-   **비고:** 즐겨찾기 기능 고려.

### FR-007-1: (신규) 중요도 표시 기능
-   **개요:** 사용자가 메모 또는 저장된 용어/설명에 중요도를 표시하고, 이를 기준으로 정렬하거나 필터링할 수 있습니다.
-   **상세 설명:**
    -   **선행 조건:** 로그인 상태, 중요도를 표시할 메모 또는 용어/설명 존재.
    -   **입력:** 대상 아이템(메모/용어) ID, 중요도 값 (예: 별점 1~5, 또는 단순 중요/보통 플래그).
    -   **처리 과정:**
        1.  **FastAPI 백엔드 API**를 통해 **PostgreSQL** DB에 해당 아이템의 중요도 정보 업데이트.
    -   **출력/결과:** 중요도 표시 성공 메시지.
    -   **후행 조건:** 해당 아이템의 중요도 변경됨.
-   **비고:** 목록 조회 시 중요도순 정렬 옵션 제공 (`PAGE_LIST.md` 참고).

## 3. 검색 및 공유

### FR-008: 용어 검색 (개인/공유)
-   **개요:** 사용자가 자신이 저장한 용어 또는 다른 사용자가 공유한 용어를 검색합니다.
-   **상세 설명:**
    -   **선행 조건:** 로그인 상태
    -   **입력:** 검색 키워드, 검색 범위 (내 용어, 공유된 용어)
    -   **처리 과정:**
        1.  프론트엔드에서 검색 요청을 **FastAPI 백엔드 API**로 전달.
        2.  **FastAPI 백엔드**는 선택된 범위에 따라 **PostgreSQL** DB에서 검색:
            -   텍스트 기반 검색: PostgreSQL의 FTS(Full-Text Search) 또는 `LIKE` 쿼리 등 활용.
            -   의미 기반 검색: 입력 키워드의 임베딩 벡터를 생성 후, **PostgreSQL (pgvector)**을 사용하여 유사한 임베딩 벡터를 가진 용어/설명 검색.
        3.  검색 결과 정렬 (관련도순, 최신순 등) 후 프론트엔드에 반환.
    -   **출력/결과:** 검색 결과 목록 (용어, 간략한 설명, 출처 등)
    -   **후행 조건:** -
-   **비고:** 검색 정확도, 다양한 검색 옵션 고려.

### FR-009: 공유된 용어 설명 열람
-   **개요:** 다른 사용자가 공개적으로 공유한 용어 정리 내용을 열람합니다.
-   **상세 설명:**
    -   **선행 조건:** 로그인 상태 (또는 비로그인 사용자도 일부 열람 가능하도록 정책 결정 필요 - FastAPI 백엔드에서 제어).
    -   **입력:** 열람할 용어 선택 (예: 인기 용어, 최신 공유 용어 목록에서 선택 또는 검색 결과에서 선택).
    -   **처리 과정:** 선택된 용어의 상세 정보를 **FastAPI 백엔드 API**를 통해 **PostgreSQL** DB에서 조회 (작성자 정보 포함). 접근 권한은 **FastAPI 백엔드**에서 제어.
    -   **출력/결과:** 선택된 용어의 상세 설명 페이지 (작성자, 작성일, 추천수, 댓글 등 포함 가능)
    -   **후행 조건:** -
-   **비고:** 추천/비추천, 댓글 기능 고려. 공유 정책 정의 필요. 공유 용어에 대한 소유권 및 편집 권한 정책 명확화 필요 (FastAPI 백엔드에서 관리).

### FR-009-1: (신규) AI 기반 링크 추천 및 수동 연결
-   **개요:** 사용자가 현재 보고 있는 메모나 용어 설명과 관련성이 높은 다른 저장된 메모/용어를 AI가 추천하고, 사용자는 이를 선택하여 수동으로 연결할 수 있습니다.
-   **상세 설명:**
    -   **선행 조건:** 로그인 상태, 임베딩 벡터가 저장된 메모/용어가 하나 이상 **PostgreSQL**에 존재.
    -   **입력 (추천 요청 시):** 현재 보고 있는 메모/용어 ID.
    -   **처리 과정 (추천):**
        1.  현재 아이템의 임베딩 벡터를 **FastAPI 백엔드**를 통해 **PostgreSQL** DB에서 조회.
        2.  **FastAPI 백엔드**에서 **PostgreSQL (pgvector)**을 사용하여 유사한 임베딩 벡터를 가진 다른 메모/용어 목록 반환.
    -   **출력 (추천):** 관련 메모/용어 추천 목록 (제목, 간략 내용 등).
    -   **입력 (수동 연결 시):** 소스 메모/용어 ID, 타겟 메모/용어 ID.
    -   **처리 과정 (수동 연결):**
        1.  두 아이템 간의 연결 관계를 **FastAPI 백엔드**를 통해 **PostgreSQL** DB에 저장.
    -   **출력 (수동 연결):** 연결 성공 메시지.
    -   **후행 조건:** 아이템 간 링크 생성됨, 링크된 정보는 상세 조회 시 표시 가능.
-   **비고:** 추천 알고리즘 및 UI/UX 상세 설계 필요.

## 4. 기타

### FR-010: PWA 지원
-   **개요:** 웹 애플리케이션을 PWA(Progressive Web App) 형태로 **초기 버전부터 제공**하여 앱 설치 없이 모바일 홈 화면 추가, 오프라인 기능 (캐싱된 콘텐츠 접근 등), 푸시 알림 (예: AI 작업 완료 알림) 등을 지원합니다.
-   **상세 설명:**
    -   웹 앱 매니페스트 (`manifest.json`) 파일 작성 및 설정 (앱 아이콘, 테마 색상, 시작 URL 등 정의) - 프론트엔드.
    -   서비스 워커(Service Worker) 등록 및 구현 (프론트엔드):
        -   주요 정적 자원 캐싱.
        -   푸시 알림 수신 로직 구현.
    -   반응형 웹 디자인 (프론트엔드).
    -   Lighthouse 등을 활용한 PWA 품질 기준 충족 노력.
    -   푸시 알림 발송: **FastAPI 백엔드**에서 특정 이벤트 발생 시 **Cloud Function (Node.js)** 호출 -> **Cloud Function**이 Firebase Cloud Messaging (FCM) 통해 사용자에게 푸시 알림 발송.
-   **비고:** **Firebase Hosting**을 통해 PWA 배포. 초기에는 핵심 콘텐츠 위주의 오프라인 지원.

### FR-011: (신규) 앱 스토어 등록 지원 (선택적 확장)
-   **개요:** 개발된 PWA를 주요 앱 스토어(예: Google Play Store, Microsoft Store)에 등록하여 사용자 접근성을 높이고 검색 가능성을 확대합니다.
-   **상세 설명:** (기존 내용과 거의 동일, 기술 스택 명시성 강화)
    -   **선행 조건:** FR-010 PWA 기능 구현 및 품질 기준 충족 (프론트엔드, **Firebase Hosting** 배포).
    -   **처리 과정:** TWA/PWABuilder 사용, 스토어 등록 절차 진행.
    -   **출력/결과:** 앱 스토어에 애플리케이션 등록 및 배포.
    -   **후행 조건:** 사용자는 앱 스토어를 통해 애플리케이션 검색 및 설치 가능.
-   **비고:** 초기에는 웹 PWA로 충분한 사용자 기반 확보 후, 필요에 따라 앱 스토어 등록을 선택적으로 추진.

### FR-012: (신규) 사용자 활동 통계 및 기본 랭킹 (점진적 개발)
-   **개요:** 사용자의 서비스 이용 현황에 대한 기본 통계를 수집하고, (선택적으로) 간단한 형태의 사용자 기여도 랭킹 기능을 제공하여 서비스 개선 및 사용자 참여를 유도합니다.
-   **상세 설명:**
    -   **선행 조건:** 로그인 상태 (FR-002).
    -   **수집 대상 (예시, 개인정보 보호 고려):** 메모/용어 생성 수, AI 설명 요청 수 등.
    -   **처리 과정 (**FastAPI 백엔드 & PostgreSQL** 활용):
        1.  사용자 활동 발생 시 **FastAPI 백엔드 API**를 통해 관련 데이터를 **PostgreSQL**의 특정 테이블에 기록.
        2.  **FastAPI 백엔드**에서 주기적으로 또는 이벤트 기반으로 집계 데이터 생성 (예: 사용자별 활동 카운트, 전체 인기 용어 목록 등).
        3.  집계된 통계 데이터는 **PostgreSQL**의 별도 테이블 또는 동일 테이블 내 요약 필드에 저장.
    -   **출력/결과 (초기 단계):** 관리자용 대시보드, 사용자 활동 요약, 인기/최신 항목 정렬 기능 (모두 **FastAPI 백엔드**에서 데이터 제공).
    -   **후행 조건:** 서비스 이용 패턴 분석 및 향후 기능 개선을 위한 기초 데이터 확보.
-   **비고:** 점진적 개발. 복잡한 랭킹/분석은 장기 과제. PostgreSQL의 유연성 활용. 